#!/usr/bin/env fish
# Interactive theme selector using Walker dmenu
# Usage: fedpunk-theme-select

# Get list of available themes
set theme_list (fedpunk-theme-list)

# Get current theme
set current_theme (fedpunk-theme-current 2>/dev/null)

# Calculate the index of current theme for preselection
set current_index -1
if test -n "$current_theme"
    set index 0
    for theme in (echo $theme_list)
        if test "$theme" = "$current_theme"
            set current_index $index
            break
        end
        set index (math $index + 1)
    end
end

# Build walker dmenu command
set walker_args --dmenu --width 300 --height 400 -p "Select theme"

# Add current theme preselection if found
if test $current_index -ge 0
    set walker_args $walker_args -c $current_index
end

# Show selection menu
set selected_theme (echo $theme_list | walker $walker_args 2>/dev/null)

# Apply selected theme if user didn't cancel
if test -n "$selected_theme"
    fedpunk-theme-set $selected_theme
else
    echo "Theme selection cancelled"
end
